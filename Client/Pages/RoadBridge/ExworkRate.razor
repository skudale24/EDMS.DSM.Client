@page "/roadbridge/exwork"


<style type="text/css">
    .header-centered th { text-align: center; }
</style>

<MudGrid>
    <MudItem xs="12" sm="12" md="12" lg="12" xl="12">
        <MudGrid>
            <MudItem xs="12" sm="6" md="6" lg="6" xl="6">
                <MudText Color="Color.Primary" Typo="Typo.h4">Exworks Rate</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="6" lg="6" xl="6" Class="d-flex flex-row-reverse flex-grow-1">
                <MudButton Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Upload" Color="Color.Primary"
                           OnClick="@UploadCSV" Size="Size.Small">
                    Ex-Works Upload
                </MudButton>
            </MudItem>
        </MudGrid>
    </MudItem>

    <MudItem xs="12" sm="12" md="12" lg="12" xl="12">
        <MudExpansionPanels >
            <MudExpansionPanel Text="Filters" IsInitiallyExpanded="true" @bind-IsExpanded="@isExpanded">
                <EditForm Model="@_exworksRateFilter">
                    <MudGrid>
                        <MudItem xs="12" sm="6" md="3" lg="3" xl="3">
                            <MudTextField @bind-Value="@_exworksRateFilter.Origin" Label="Origin"
                                          Variant="Variant.Outlined" Margin="Margin.Dense"/>
                        </MudItem>
                        <MudItem xs="12" sm="6" md="3" lg="3" xl="3">
                            <MudTextField @bind-Value="@_exworksRateFilter.Destination" Label="Destination"
                                          Variant="Variant.Outlined" Margin="Margin.Dense"/>
                        </MudItem>
                        <MudItem xs="12" sm="12" md="12" lg="12" xl="12">
                            <MudButton Color="Color.Primary" ButtonType="ButtonType.Submit"
                                       Variant="Variant.Filled" OnClick="@OnSearch" Class="mr-1" Size="Size.Small">
                                Submit
                            </MudButton>
                            <MudButton Color="Color.Default" ButtonType="ButtonType.Reset"
                                       Variant="Variant.Filled" OnClick="@ResetFilters" Class="mr-1" Size="Size.Small">
                                Reset
                            </MudButton>
                        </MudItem>
                    </MudGrid>
                </EditForm>
            </MudExpansionPanel>
        </MudExpansionPanels>
    </MudItem>

    <MudItem xs="12" sm="12" md="12" lg="12" xl="12">
        <MudTable ServerData="@(new Func<TableState, Task<TableData<SearchExworksRateDto>>>(ServerReload))"
                  Breakpoint="Breakpoint.None" LoadingProgressColor="Color.Info" CustomHeader="true"
                  HeaderClass="table-head-bordered" @ref="@_tableRef" Dense="true" Hover="true" RowsPerPage="20">
            <HeaderContent>
                <MudTHeadRow Class="header-centered">

                    <MudTh colspan="5" style="text-align: center">
                        <b></b>
                    </MudTh>
                    <MudTh colspan="7" style="text-align: center">
                        <b>Transportation</b>
                    </MudTh>

                </MudTHeadRow>
                <MudTHeadRow>
                    <MudTh Style="padding: 3px">
                        <b>#</b>
                    </MudTh>
                    <MudTh Style="padding: 3px">
                        <b>Origin</b>
                    </MudTh>
                    <MudTh Style="padding: 3px; width: 10px !important">
                        <b>Destination</b>
                    </MudTh>
                    <MudTh Style="padding: 3px">
                        <b>Custom Clearance</b>
                    </MudTh>
                    <MudTh Style="padding: 3px">
                        <b>ACD / ACI / ENS per HBLA</b>
                    </MudTh>
                    <MudTh Style="padding: 3px">
                        <b>IHC / THC per W/M</b>
                    </MudTh>
                    <MudTh Style="padding: 3px">
                        <b>Doc per HBL</b>
                    </MudTh>
                    <MudTh Style="padding: 3px">
                        <b>1 tons - 2 cbm</b>
                    </MudTh>
                    <MudTh Style="padding: 3px">
                        <b>3 tons - 6 cbm</b>

                    </MudTh>
                    <MudTh Style="padding: 3px">
                        <b>5 tons - 10 cbm</b>
                    </MudTh>
                    <MudTh Style="padding: 3px">
                        <b>7 tons - 14 cbm</b>
                    </MudTh>
                    <MudTh width="15px" Style="padding: 0px">
                        <b>Uploaded Date</b>
                    </MudTh>
                </MudTHeadRow>
            </HeaderContent>
            <NoRecordsContent>
                <MudText>No matching records found</MudText>
            </NoRecordsContent>

            <RowTemplate>
                <MudTd DataLabel="#">@GetRowNumber(context)</MudTd>
                <MudTd DataLabel="Origin">@context.Origin</MudTd>
                <MudTd DataLabel="Destination">@context.Destination</MudTd>
                <MudTd DataLabel="Custom Clearance">@context.CustomClearance</MudTd>
                <MudTd DataLabel="ACD / ACI / ENS per HBLA">@context.AcdAciEnsPerHbl</MudTd>
                <MudTd DataLabel="IHC / THC per W/M">@context.IhcThcPerWm</MudTd>
                <MudTd DataLabel="Doc per HBL">@context.DocPerHbl</MudTd>
                <MudTd DataLabel="1 tons- 2 cbm">@context.OneTonsTwoCbm</MudTd>
                <MudTd DataLabel="3 tons - 6 cbm">@context.ThreeTonsSixCbm</MudTd>
                <MudTd DataLabel="5 tons - 10 cbm">@context.FiveTonsTenCbm</MudTd>
                <MudTd DataLabel="7 tons - 14 cbm">@context.SevenTonsFourteenCbm</MudTd>
                <MudTd DataLabel="Uploaded Date" Style="padding: 0px !important" width="10%">
                    @context.UploadedOn.ToLocalTime().ToString("dd-MMM-yyyy HH:mm tt")
                </MudTd>
            </RowTemplate>
            <PagerContent>
                <MudPagination Color="Color.Secondary" SelectedChanged="PageChanged"
                               Count="@((_tableRef.GetFilteredItemsCount() + _tableRef.RowsPerPage - 1) / _tableRef.RowsPerPage)"
                               Class="pa-4"/>
            </PagerContent>
        </MudTable>
    </MudItem>
</MudGrid>
