@page "/roadbridge/plc"


<MudGrid>
    <MudItem xs="12" sm="12" md="12" lg="12" xl="12">
        <MudGrid>
            <MudItem xs="12" sm="6" md="6" lg="6" xl="6">
                <MudText Color="Color.Primary" Typo="Typo.h4">Post Landing Cost</MudText>
            </MudItem>
            <MudItem xs="12" sm="6" md="6" lg="6" xl="6" Class="d-flex flex-row-reverse flex-grow-1">
                <MudButton Variant="Variant.Filled" StartIcon="@Icons.Material.Filled.Upload"
                           Color="Color.Primary" OnClick="@UploadCSV" Size="Size.Small">
                    Upload Post Landing Cost
                </MudButton>
            </MudItem>
        </MudGrid>
    </MudItem>

    <MudItem xs="12" sm="12" md="12" lg="12" xl="12">
        <MudExpansionPanels>
            <MudExpansionPanel Text="Filters" IsInitiallyExpanded="true" @bind-IsExpanded="@isExpanded">

                <EditForm Model="@_postLandingCostFilter">
                    <MudGrid>
                        <MudItem xs="12" sm="6" md="4" lg="4" xl="3">
                            <MudTextField @bind-Value="@_postLandingCostFilter.Destination" Label="Destination" Variant="Variant.Outlined" Class="xs-12 sm-4 lg-3 xl-3" Margin="Margin.Dense"/>
                        </MudItem>
                        <MudItem xs="12" sm="12" md="12" lg="12" xl="12">
                            <MudButton Color="Color.Primary" ButtonType="ButtonType.Submit" Variant="Variant.Filled" Class="mr-1" OnClick="OnSearch" Size="Size.Small">Submit</MudButton>
                            <MudButton Color="Color.Default" ButtonType="ButtonType.Reset" Variant="Variant.Filled" Class="mr-1" OnClick="ResetFilters" Size="Size.Small">Reset</MudButton>
                        </MudItem>
                    </MudGrid>
                </EditForm>
            </MudExpansionPanel>
        </MudExpansionPanels>
    </MudItem>

    <MudItem xs="12" sm="12" md="12" lg="12" xl="12">
        <MudTable ServerData="@(new Func<TableState, Task<TableData<SearchPostLandingCostDto>>>(ServerReload))" Breakpoint="Breakpoint.None" RowsPerPage="20" LoadingProgressColor="Color.Info" @ref="@_tableRef" Dense="true" Hover="true">
            <HeaderContent>
                <MudTh>
                    <b>#</b>
                </MudTh>
                <MudTh>
                    <b>Destination</b>
                </MudTh>
                <MudTh>
                    <b>Custom Clearance</b>
                </MudTh>
                <MudTh>
                    <b>CFS charges(per CBM)</b>
                </MudTh>
                <MudTh>
                    <b>PLC per W/m</b>
                </MudTh>
                <MudTh>
                    <b>Transport</b>
                </MudTh>
                <MudTh>
                    <b>GST</b>
                </MudTh>
                <MudTh>
                    <b>Uploaded Date</b>
                </MudTh>
            </HeaderContent>
            <NoRecordsContent>
                <MudText>No matching records found</MudText>
            </NoRecordsContent>

            <RowTemplate>
                <MudTd DataLabel="#">@GetRowNumber(context)</MudTd>
                <MudTd DataLabel="Destination">@context.Destination</MudTd>
                <MudTd DataLabel="Custom Clearance">@context.CustomClearanceCharges</MudTd>
                <MudTd DataLabel="CFS charges(per CBM)">@context.CfsChargesPerCbm</MudTd>
                <MudTd DataLabel="PLC per W/m">@context.PlcPerWm</MudTd>
                <MudTd DataLabel="Transport">@context.Transport</MudTd>
                <MudTd DataLabel="GST">@context.Gst</MudTd>
                <MudTd DataLabel="Uploaded Date" width="10%">@context.UploadedOn.ToLocalTime().ToString("dd-MMM-yyyy HH:mm tt")</MudTd>
            </RowTemplate>
            <PagerContent>
                <MudPagination Color="Color.Secondary" SelectedChanged="PageChanged" Count="@((_tableRef.GetFilteredItemsCount() + _tableRef.RowsPerPage - 1) / _tableRef.RowsPerPage)" Class="pa-4"/>
            </PagerContent>
        </MudTable>
    </MudItem>
</MudGrid>
